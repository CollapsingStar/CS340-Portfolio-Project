-- MySQL Script generated by MySQL Workbench
-- Wed 01 Jun 2022 02:12:22 PM PDT
-- Model: CS340 Portfolio Project Version: 1.0
-- MySQL Workbench Forward Engineering
-- CS340 Portfolio Project DDL File: Valor Nash & Kyle Sevier

SET @OLD_UNIQUE_CHECKS=@@UNIQUE_CHECKS, UNIQUE_CHECKS=0;
SET @OLD_FOREIGN_KEY_CHECKS=@@FOREIGN_KEY_CHECKS, FOREIGN_KEY_CHECKS=0;
SET @OLD_SQL_MODE=@@SQL_MODE, SQL_MODE='ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION';


-- -----------------------------------------------------
-- Table `dates`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `dates` ;

CREATE TABLE IF NOT EXISTS `dates` (
  `date` DATETIME NOT NULL,
  `day_of_week` VARCHAR(45) NOT NULL,
  `holiday` TINYINT NOT NULL,
  `weather` VARCHAR(45) NOT NULL,
  PRIMARY KEY (`date`),
  UNIQUE INDEX `date_UNIQUE` (`date` ASC) VISIBLE)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `guests`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `guests` ;

CREATE TABLE IF NOT EXISTS `guests` (
  `guest_id` INT NOT NULL AUTO_INCREMENT,
  `guest_name` VARCHAR(45) NOT NULL,
  `email` VARCHAR(45) NOT NULL,
  `phone_num` VARCHAR(45) NULL DEFAULT NULL,
  UNIQUE INDEX `guest_id_UNIQUE` (`guest_id` ASC) VISIBLE,
  UNIQUE INDEX `email_UNIQUE` (`email` ASC) VISIBLE,
  PRIMARY KEY (`guest_id`))
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `orders`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `orders` ;

CREATE TABLE IF NOT EXISTS `orders` (
  `order_id` INT NOT NULL AUTO_INCREMENT,
  `season_pass_holder` TINYINT NOT NULL,
  `guest_id` INT NULL DEFAULT NULL,
  `date` DATETIME NOT NULL,
  `ticket` INT NOT NULL,
  INDEX `fk_orders_date1_idx` (`date` ASC) VISIBLE,
  UNIQUE INDEX `order_id_UNIQUE` (`order_id` ASC) VISIBLE,
  INDEX `fk_orders_guests` (`guest_id` ASC) VISIBLE,
  PRIMARY KEY (`order_id`),
  CONSTRAINT `fk_orders_guests`
    FOREIGN KEY (`guest_id`)
    REFERENCES `guests` (`guest_id`)
    ON DELETE SET NULL
    ON UPDATE CASCADE,
  CONSTRAINT `fk_orders_date1`
    FOREIGN KEY (`date`)
    REFERENCES `dates` (`date`)
    ON DELETE CASCADE
    ON UPDATE CASCADE)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `attractions`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `attractions` ;

CREATE TABLE IF NOT EXISTS `attractions` (
  `ride_id` INT NOT NULL AUTO_INCREMENT,
  `num_riders` INT NOT NULL,
  `date_created` DATETIME NOT NULL,
  `ride_name` VARCHAR(45) NOT NULL,
  PRIMARY KEY (`ride_id`),
  INDEX `fk_attractions_date1_idx` (`date_created` ASC) VISIBLE,
  UNIQUE INDEX `ride_ID_UNIQUE` (`ride_id` ASC) VISIBLE,
  CONSTRAINT `fk_attractions_date1`
    FOREIGN KEY (`date_created`)
    REFERENCES `dates` (`date`)
    ON DELETE CASCADE
    ON UPDATE CASCADE)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `master_table`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `master_table` ;

CREATE TABLE IF NOT EXISTS `master_table` (
  `table_id` INT NOT NULL AUTO_INCREMENT,
  `total_guests` INT NOT NULL,
  `total_riders` INT NULL DEFAULT NULL,
  `date` DATETIME NOT NULL,
  INDEX `fk_master_table_date1_idx` (`date` ASC) VISIBLE,
  PRIMARY KEY (`table_id`),
  UNIQUE INDEX `date_UNIQUE` (`date` ASC) VISIBLE,
  CONSTRAINT `fk_master_table_date1`
    FOREIGN KEY (`date`)
    REFERENCES `dates` (`date`)
    ON DELETE CASCADE
    ON UPDATE CASCADE)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `guests_has_attractions`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `guests_has_attractions` ;

CREATE TABLE IF NOT EXISTS `guests_has_attractions` (
  `guest_attraction_id` INT NOT NULL AUTO_INCREMENT,
  `guest_id` INT NOT NULL,
  `ride_id` INT NOT NULL,
  `date` DATETIME NOT NULL,
  INDEX `fk_guests_has_attractions_attractions1_idx` (`ride_id` ASC) VISIBLE,
  INDEX `fk_guests_has_attractions_guests1_idx` (`guest_id` ASC) VISIBLE,
  INDEX `fk_date_idx` (`date` ASC) VISIBLE,
  INDEX `fk_guests_has_attractions_attractions1` (`ride_id` ASC) VISIBLE,
  PRIMARY KEY (`guest_attraction_id`),
  CONSTRAINT `fk_guests_has_attractions_guests1`
    FOREIGN KEY (`guest_id`)
    REFERENCES `guests` (`guest_id`)
    ON DELETE CASCADE
    ON UPDATE CASCADE,
  CONSTRAINT `fk_guests_has_attractions_attractions1`
    FOREIGN KEY (`ride_id`)
    REFERENCES `attractions` (`ride_id`)
    ON DELETE CASCADE
    ON UPDATE CASCADE,
  CONSTRAINT `fk_date`
    FOREIGN KEY (`date`)
    REFERENCES `dates` (`date`)
    ON DELETE CASCADE
    ON UPDATE CASCADE)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Data for table `dates`
-- -----------------------------------------------------
START TRANSACTION;
INSERT INTO `dates` (`date`, `day_of_week`, `holiday`, `weather`) VALUES ('2022-06-22 00:00:00', 'Sunday', 0, 'Sunny');
INSERT INTO `dates` (`date`, `day_of_week`, `holiday`, `weather`) VALUES ('2022-06-23 00:00:00', 'Monday', 1, 'Rainy');
INSERT INTO `dates` (`date`, `day_of_week`, `holiday`, `weather`) VALUES ('2022-06-24 00:00:00', 'Tuesday', 1, 'Cloudy');

COMMIT;


-- -----------------------------------------------------
-- Data for table `guests`
-- -----------------------------------------------------
START TRANSACTION;
INSERT INTO `guests` (`guest_id`, `guest_name`, `email`, `phone_num`) VALUES (1, 'Tom Smith', 'tomsmith@email.com', '4561234565');
INSERT INTO `guests` (`guest_id`, `guest_name`, `email`, `phone_num`) VALUES (2, 'Anakin Skywalker', 'jedicouncil@email.com', '0001233121');
INSERT INTO `guests` (`guest_id`, `guest_name`, `email`, `phone_num`) VALUES (3, 'Eren Jeager', 'eren@email.com', '3123412331');
INSERT INTO `guests` (`guest_id`, `guest_name`, `email`, `phone_num`) VALUES (4, 'Keanu Reeves', 'keanu@email.com', '3115419008');

COMMIT;


-- -----------------------------------------------------
-- Data for table `orders`
-- -----------------------------------------------------
START TRANSACTION;
INSERT INTO `orders` (`order_id`, `season_pass_holder`, `guest_id`, `date`, `ticket`) VALUES (1, 0, 1, '2022-06-22 00:00:00', 1);
INSERT INTO `orders` (`order_id`, `season_pass_holder`, `guest_id`, `date`, `ticket`) VALUES (2, 1, 2, '2022-06-23 00:00:00', 1);
INSERT INTO `orders` (`order_id`, `season_pass_holder`, `guest_id`, `date`, `ticket`) VALUES (3, 0, 2, '2022-06-23 00:00:00', 0);
INSERT INTO `orders` (`order_id`, `season_pass_holder`, `guest_id`, `date`, `ticket`) VALUES (4, 1, 1, '2022-06-24 00:00:00', 1);

COMMIT;


-- -----------------------------------------------------
-- Data for table `attractions`
-- -----------------------------------------------------
START TRANSACTION;
INSERT INTO `attractions` (`ride_id`, `num_riders`, `date_created`, `ride_name`) VALUES (1, 23, '2022-06-22 00:00:00', 'Medusa');
INSERT INTO `attractions` (`ride_id`, `num_riders`, `date_created`, `ride_name`) VALUES (2, 11, '2022-06-23 00:00:00', 'Whirler');
INSERT INTO `attractions` (`ride_id`, `num_riders`, `date_created`, `ride_name`) VALUES (3, 2, '2022-06-23 00:00:00', 'Thor\'s Hammer');

COMMIT;


-- -----------------------------------------------------
-- Data for table `master_table`
-- -----------------------------------------------------
START TRANSACTION;
INSERT INTO `master_table` (`table_id`, `total_guests`, `total_riders`, `date`) VALUES (1, 122, 50, '2022-06-22 00:00:00');
INSERT INTO `master_table` (`table_id`, `total_guests`, `total_riders`, `date`) VALUES (2, 150, 89, '2022-06-23 00:00:00');
INSERT INTO `master_table` (`table_id`, `total_guests`, `total_riders`, `date`) VALUES (3, 233, 105, '2022-06-24 00:00:00');

COMMIT;


-- -----------------------------------------------------
-- Data for table `guests_has_attractions`
-- -----------------------------------------------------
START TRANSACTION;
INSERT INTO `guests_has_attractions` (`guest_attraction_id`, `guest_id`, `ride_id`, `date`) VALUES (1, 1, 1, '2022-06-22 00:00:00');
INSERT INTO `guests_has_attractions` (`guest_attraction_id`, `guest_id`, `ride_id`, `date`) VALUES (2, 2, 2, '2022-06-23 00:00:00');
INSERT INTO `guests_has_attractions` (`guest_attraction_id`, `guest_id`, `ride_id`, `date`) VALUES (3, 2, 3, '2022-06-24 00:00:00');

COMMIT;


SET SQL_MODE=@OLD_SQL_MODE;
SET FOREIGN_KEY_CHECKS=@OLD_FOREIGN_KEY_CHECKS;
SET UNIQUE_CHECKS=@OLD_UNIQUE_CHECKS;
